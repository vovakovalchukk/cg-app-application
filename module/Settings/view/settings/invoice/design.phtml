<?php $this->headLink()->appendStylesheet($this->basePath() . CG_UI\Module::PUBLIC_FOLDER . 'css/common/subheader-hide.css'); ?>
<?php $this->inlineScript()->captureStart(); ?>
$(document).ready(function() {
    require.config({
        paths: {
            'InvoiceDesigner': "<?=$this->basePath() . Settings\Module::PUBLIC_FOLDER . 'js/InvoiceDesigner';?>"
        }
    });

    require(['InvoiceDesigner/Application'], function(designerApp)
    {
        designerApp.init();
    });
});
<?php $this->inlineScript()->captureEnd(); ?>
<div id="invoice-controls-bar" class="sidebar sidebar-fixed sidebar-left sidebar-invoice-designer">
    <!--Invoice Controls-->

    <div class="button toPdfButton" style="margin:10px">To Pdf</div>
</div>
<div id="invoice-template">
    <!--Invoice Template-->
</div>
<div id="element-inspector-bar" class="sidebar sidebar-fixed sidebar-right sidebar-invoice-designer">
    <!--Element Inspectors-->

</div>

<script>
$(document).on('click', '.toPdfButton', function() {
    var invoiceLayout = {
        'type': 'Invoice',
        'name': 'preview',
        'minHeight': '842',
        'minWidth': '595',
        'organisationUnitId': 1,
        'elements': [
            {   'type': 'text',
                'width': 595,
                'fontFamily': 'CG\\Template\\FontFamily\\Helvetica',
                'x': 0,
                'y': 40,
                'fontSize': 60,
                'align': 'centre',
                'fontColour': 'black',
                'text': "{{b}}INVOICE!"
            }, {
                'type': 'text',
                'width': 595,
                'fontFamily': 'CG\\Template\\FontFamily\\Helvetica',
                'x': 0,
                'y': 110,
                'align': 'centre',
                'fontSize': 12,
                'fontColour': 'black',
                'text': '{{i}}made with love from {{n}}ChannelGrabber.com'
            }, {
                'type': 'orderTable',
                'width': 555,
                'height': 500,
                'x': 20,
                'y': 150
            }, {
                'type': 'text\\ReadOnly\\DeliveryAddress',
                'fontFamily': 'CG\\Template\\FontFamily\\Helvetica',
                'fontSize': 12,
                'fontColour': 'black',
                'width': 150,
                'height': 20,
                'align': 'right',
                'x': 420,
                'y': 20
            }, {
                'type': 'image',
                'source': 'data:image/png;base64,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',
                'format': 'png',
                'x': 20,
                'y': 20,
                'height': 64,
                'width': 75
            }
        ]
    };

    var postForm = function(url, data, target) {
        var form = document.createElement("form");
        form.action = url;
        form.method = 'POST';
        form.target = target || "_self";
        if (data) {
            for (var key in data) {
                var input = document.createElement("textarea");
                input.name = key;
                input.value = typeof data[key] === "object" ? JSON.stringify(data[key]) : data[key];
                form.appendChild(input);
            }
        }
        form.submit();
    };
    var templateJson = {'template': JSON.stringify(invoiceLayout)};
    postForm('https://app.channelgrabber.com.local/orders/invoice/preview', templateJson);
});



$(document).ready(function() {
    require(['mustache','cg-mustache'], function(Mustache, CGMustache) {
        var templateUrl = '<?= $this->basePath() . CG_UI\Module::PUBLIC_FOLDER . 'templates/elementInspector.mustache' ?>';
        var variables = {
            id: 'deliveryAddress',
            title: 'Edit Delivery Address',
            display: false,
            content: '<input value="Unit 1 Malt House"/><br /><input value="Deva Business Centre"/><br /><input value="Manchester"/><br /><input value="M1 3BD"/>'
        };
        CGMustache.get().fetchTemplate(templateUrl, function(template) {
            var renderedTemplate = Mustache.render(template, variables);
            $('#element-inspector-bar').append(renderedTemplate);
        });

        var variables = {
            id: 'font',
            title: 'Font',
            display: true,
            content: '<input type="radio" name="font"/> Font 1<br /><input type="radio" name="font" selected="selected"/> Font 2<br /><input type="radio" name="font"/> Font 3<br />'
        };
        CGMustache.get().fetchTemplate(templateUrl, function(template) {
            var renderedTemplate = Mustache.render(template, variables);
            $('#element-inspector-bar').append(renderedTemplate);
        });

        var variables = {
            id: 'border',
            title: 'Border',
            content: '<input type="radio" name="font"/> Border 1<br /><input type="radio" name="font"/> Border 2<br /><input type="radio" name="font"/> Border 3<br />'
        };
        CGMustache.get().fetchTemplate(templateUrl, function(template) {
            var renderedTemplate = Mustache.render(template, variables);
            $('#element-inspector-bar').append(renderedTemplate);
        });
    });
});
</script>